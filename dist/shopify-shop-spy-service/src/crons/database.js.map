{
  "version": 3,
  "sources": ["../../../../src/crons/database.ts"],
  "sourcesContent": ["import { computeProductsSalesAndTurnover } from '@src/mongodb/computeProductsSalesAndTurnover';\nimport { computeSalesAndTurnover } from '@src/mongodb/computeSalesAndTurnover';\nimport { client } from '@src/mongodb/conf';\nimport { getShops } from '@src/mongodb/getShops';\nimport { scheduleJob } from 'node-schedule';\n\nexport const startComputeSalesAndTurnover = async () => {\n  const job = scheduleJob('0 * * * *', async () => {\n    await client.connect();\n    console.info('RUNNING ComputeSalesAndTurnover');\n    const shops = await getShops();\n\n    for (let index = 0; index < shops.length; index++) {\n      const shop = shops[index];\n\n      await computeSalesAndTurnover(shop);\n      process.stdout.write(`Processed: ${index + 1}/${shops.length}\\r`);\n    }\n    console.info('DONE ComputeSalesAndTurnover');\n  });\n\n  return job;\n};\n\nexport const startComputeProductsSalesAndTurnover = async () => {\n  const shops = await getShops();\n\n  for (let index = 0; index < shops.length; index++) {\n    const shop = shops[index];\n\n    await computeProductsSalesAndTurnover(shop);\n    process.stdout.write(`Processed: ${index + 1}/${shops.length}\\r`);\n  }\n  console.info('DONE ComputeProductsSalesAndTurnover');\n  const job = scheduleJob('0 0 * * *', async () => {\n    await client.connect();\n    console.info('RUNNING ComputeProductsSalesAndTurnover');\n    const shops = await getShops();\n\n    for (let index = 0; index < shops.length; index++) {\n      const shop = shops[index];\n\n      await computeProductsSalesAndTurnover(shop);\n      process.stdout.write(`Processed: ${index + 1}/${shops.length}\\r`);\n    }\n    console.info('DONE ComputeProductsSalesAndTurnover');\n  });\n\n  return job;\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CAAgD;AAChD,qCAAwC;AACxC,kBAAuB;AACvB,sBAAyB;AACzB,2BAA4B;AAErB,MAAM,+BAA+B,YAAY;AACtD,QAAM,UAAM,kCAAY,aAAa,YAAY;AAC/C,UAAM,mBAAO,QAAQ;AACrB,YAAQ,KAAK,iCAAiC;AAC9C,UAAM,QAAQ,UAAM,0BAAS;AAE7B,aAAS,QAAQ,GAAG,QAAQ,MAAM,QAAQ,SAAS;AACjD,YAAM,OAAO,MAAM,KAAK;AAExB,gBAAM,wDAAwB,IAAI;AAClC,cAAQ,OAAO,MAAM,cAAc,QAAQ,KAAK,MAAM,UAAU;AAAA,IAClE;AACA,YAAQ,KAAK,8BAA8B;AAAA,EAC7C,CAAC;AAED,SAAO;AACT;AAEO,MAAM,uCAAuC,YAAY;AAC9D,QAAM,QAAQ,UAAM,0BAAS;AAE7B,WAAS,QAAQ,GAAG,QAAQ,MAAM,QAAQ,SAAS;AACjD,UAAM,OAAO,MAAM,KAAK;AAExB,cAAM,wEAAgC,IAAI;AAC1C,YAAQ,OAAO,MAAM,cAAc,QAAQ,KAAK,MAAM,UAAU;AAAA,EAClE;AACA,UAAQ,KAAK,sCAAsC;AACnD,QAAM,UAAM,kCAAY,aAAa,YAAY;AAC/C,UAAM,mBAAO,QAAQ;AACrB,YAAQ,KAAK,yCAAyC;AACtD,UAAMA,SAAQ,UAAM,0BAAS;AAE7B,aAAS,QAAQ,GAAG,QAAQA,OAAM,QAAQ,SAAS;AACjD,YAAM,OAAOA,OAAM,KAAK;AAExB,gBAAM,wEAAgC,IAAI;AAC1C,cAAQ,OAAO,MAAM,cAAc,QAAQ,KAAKA,OAAM,UAAU;AAAA,IAClE;AACA,YAAQ,KAAK,sCAAsC;AAAA,EACrD,CAAC;AAED,SAAO;AACT;",
  "names": ["shops"]
}

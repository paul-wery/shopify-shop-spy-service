{
  "version": 3,
  "sources": ["../../../../src/proxy/index.ts"],
  "sourcesContent": ["import axios from 'axios';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst { PROXY_USERNAME, PROXY_PASSWORD } = process.env;\n\nexport class PoolRequest {\n  private readonly _MAX_REQUESTS_BY_ID = 50;\n  private _sessionId: string;\n  private _requestsCount: number;\n  private _logs: { sessionId: string; requestsCount: number }[] = [];\n\n  constructor() {\n    this._switchSession();\n  }\n\n  private _switchSession() {\n    console.info('Switching session');\n    this._logs.push({\n      sessionId: this._sessionId,\n      requestsCount: this._requestsCount,\n    });\n    this._sessionId = uuidv4().replace(/-/g, '');\n    this._requestsCount = 0;\n  }\n\n  public get(url: string) {\n    this._requestsCount++;\n    if (this._requestsCount >= this._MAX_REQUESTS_BY_ID) {\n      this._switchSession();\n    }\n    // console.log('Request count:', this._requestsCount);\n    try {\n      return axios(url, {\n        proxy: {\n          protocol: 'http',\n          host: 'zproxy.lum-superproxy.io',\n          port: 22225,\n          auth: {\n            // username: `${PROXY_USERNAME}-session-${this._sessionId}`,\n            username: `${PROXY_USERNAME}`,\n            password: PROXY_PASSWORD,\n          },\n        },\n      });\n    } catch (error) {\n      console.error(error.message);\n      if (error.message.includes('430')) {\n        this._switchSession();\n      }\n    }\n    return;\n  }\n\n  public getLogs() {\n    return this._logs;\n  }\n}\n\nexport const poolRequest = new PoolRequest();\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAkB;AAClB,kBAA6B;AAE7B,MAAM,EAAE,gBAAgB,eAAe,IAAI,QAAQ;AAE5C,MAAM,YAAY;AAAA,EACN,sBAAsB;AAAA,EAC/B;AAAA,EACA;AAAA,EACA,QAAwD,CAAC;AAAA,EAEjE,cAAc;AACZ,SAAK,eAAe;AAAA,EACtB;AAAA,EAEQ,iBAAiB;AACvB,YAAQ,KAAK,mBAAmB;AAChC,SAAK,MAAM,KAAK;AAAA,MACd,WAAW,KAAK;AAAA,MAChB,eAAe,KAAK;AAAA,IACtB,CAAC;AACD,SAAK,iBAAa,YAAAA,IAAO,EAAE,QAAQ,MAAM,EAAE;AAC3C,SAAK,iBAAiB;AAAA,EACxB;AAAA,EAEO,IAAI,KAAa;AACtB,SAAK;AACL,QAAI,KAAK,kBAAkB,KAAK,qBAAqB;AACnD,WAAK,eAAe;AAAA,IACtB;AAEA,QAAI;AACF,iBAAO,aAAAC,SAAM,KAAK;AAAA,QAChB,OAAO;AAAA,UACL,UAAU;AAAA,UACV,MAAM;AAAA,UACN,MAAM;AAAA,UACN,MAAM;AAAA;AAAA,YAEJ,UAAU,GAAG;AAAA,YACb,UAAU;AAAA,UACZ;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH,SAAS,OAAP;AACA,cAAQ,MAAM,MAAM,OAAO;AAC3B,UAAI,MAAM,QAAQ,SAAS,KAAK,GAAG;AACjC,aAAK,eAAe;AAAA,MACtB;AAAA,IACF;AACA;AAAA,EACF;AAAA,EAEO,UAAU;AACf,WAAO,KAAK;AAAA,EACd;AACF;AAEO,MAAM,cAAc,IAAI,YAAY;",
  "names": ["uuidv4", "axios"]
}
